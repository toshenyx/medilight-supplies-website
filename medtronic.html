<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medtronic Devices & Supplies - MEDILIGHT SUPPLIES</title>
    <link rel="stylesheet" href="all.css">
</head>

<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="logo">
                <img src="images/MEDLOGO.PNG.jpg" alt="Medilight Logo">
            </div>

            <div class="search-bar">
                <input type="text" placeholder="Search for...">
            </div>

            <div class="icons">
                <!-- Wishlist Icon -->
                <div class="icon">
                    <a href="wishlist.html">
                        <img src="images/wishlist.png" alt="Wishlist">
                        <div>Wishlist</div>
                    </a>
                </div>

                <!-- Cart Icon -->
                <div class="icon">
                    <a href="cart.html">
                        <img src="images/cart.png" alt="Cart">
                        <div>My Cart</div>
                    </a>
                </div>
            </div>
        </div>

        <!-- PAGE TITLE -->
        <h1 class="page-title">Medtronic Brand Devices and Implants</h1>

        <!-- DYNAMIC PRODUCTS GRID -->
        <div class="pharma-equipment-grid" id="products-container">
            Loading products...
        </div>
    </div>

    <!-- FETCH PRODUCTS SCRIPT -->
    <script>
        fetch("fetch_products.php?brand=Medtronic&category=Devices")
            .then(response => response.json())
            .then(data => {
                const container = document.getElementById("products-container");
                container.innerHTML = ""; // Clear loading text

                if (data.length === 0) {
                    container.innerHTML = "<p>No products available.</p>";
                    return;
                }

                data.forEach(product => {
                    container.innerHTML += `
                        <div class="equipment-item" data-id="${product.id}">
                            <img src="${product.image_url}" alt="${product.product_name}" class="equipment-img">
                            <h3 class="equipment-name">${product.product_name}</h3>
                            <p class="equipment-description">${product.description}</p>
                            <p class="equipment-price">Ksh ${Number(product.price).toLocaleString()}</p>
                            <button class="add-btn equipment-cart">üõí Add to Cart</button>
                            <button class="add-btn equipment-wishlist">‚ù§Ô∏è Wishlist</button>
                        </div>
                    `;
                });

                // Add event listeners for Cart buttons
                document.querySelectorAll(".equipment-cart").forEach(button => {
                    button.addEventListener("click", function() {
                        const productDiv = this.closest(".equipment-item");
                        const productId = productDiv.getAttribute("data-id");
                        fetch("add_to_cart.php", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify({ product_id: productId })
                        })
                        .then(res => res.json())
                        .then(response => alert(response.message))
                        .catch(err => console.error("Error adding to cart:", err));
                    });
                });

                // Add event listeners for Wishlist buttons
                document.querySelectorAll(".equipment-wishlist").forEach(button => {
                    button.addEventListener("click", function() {
                        const productDiv = this.closest(".equipment-item");
                        const productId = productDiv.getAttribute("data-id");
                        fetch("add_to_wishlist.php", {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json"
                            },
                            body: JSON.stringify({ product_id: productId })
                        })
                        .then(res => res.json())
                        .then(response => alert(response.message))
                        .catch(err => console.error("Error adding to wishlist:", err));
                    });
                });

            })
            .catch(err => {
                console.error("Error loading products:", err);
                document.getElementById("products-container").innerHTML = "<p>Error loading products.</p>";
            });
    </script>
</body>

</html>
